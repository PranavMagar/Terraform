??? from here until ???END lines may have been inserted/deleted
from flask import Flask, render_template, request, redirect, url_for, jsonify
import pandas as pd
import os
from datetime import datetime

app = Flask(__name__)
CSV_FILE = "expenses.csv"

# Ensure CSV exists
if not os.path.exists(CSV_FILE):
    df = pd.DataFrame(columns=["Date", "Category", "Amount", "Description"])
    df.to_csv(CSV_FILE, index=False)

def read_df():
    return pd.read_csv(CSV_FILE)

def write_df(df):
    df.to_csv(CSV_FILE, index=False)

@app.route("/")
def dashboard():
    df = read_df()
    total = df["Amount"].sum() if not df.empty else 0.0
    now = datetime.now()
    month_total = df[pd.to_datetime(df['Date']).dt.month == now.month]["Amount"].sum() if not df.empty else 0.0
    avg_total = df["Amount"].mean() if not df.empty else 0.0
    categories = ["Food", "Transport", "Bills", "Shopping", "Other"]

    return render_template("dashboard.html",
                           total=round(total, 2),
                           month_total=round(month_total, 2),
                           avg_total=round(avg_total, 2),
                           categories=categories)

@app.route("/add", methods=["GET", "POST"])
def add_expense():
    if request.method == "POST":
        date = request.form.get("date")
        category = request.form.get("category")
        amount = request.form.get("amount")
        description = request.form.get("description", "")

        if not date or not category or not amount:
            return "Date, Category and Amount are required", 400
        try:
            amount = float(amount)
        except:
            return "Amount must be numeric", 400

        df = read_df()
        new_row = pd.DataFrame([[date, category, amount, description]], columns=df.columns)
        df = pd.concat([df, new_row], ignore_index=True)
        write_df(df)
        return redirect(url_for('dashboard'))

    categories = ["Food", "Transport", "Bills", "Shopping", "Other"]
    return render_template("add.html", categories=categories)

@app.route("/reports")
def reports():
    df = read_df()
    if df.empty:
        summary = {}
        monthly = {}
    else:
        summary = df.groupby("Category")["Amount"].sum().round(2).to_dict()
        monthly = df.groupby("Date")["Amount"].sum().sort_index().round(2).to_dict()
    return render_template("reports.html", summary=summary, monthly=monthly)

@app.route("/delete/<int:index>", methods=["POST"])
def delete_expense(index):
    df = read_df()
    if index in df.index:
        df = df.drop(index).reset_index(drop=True)
        write_df(df)
    return redirect(url_for('dashboard'))

@app.route("/api/chart-data")
def chart_data():
    df = read_df()
    if df.empty:
        pie = {}
        line = {}
    else:
        pie = df.groupby("Category")["Amount"].sum().round(2).to_dict()
        line = df.groupby("Date")["Amount"].sum().sort_index().round(2).to_dict()
    return jsonify({"pie": pie, "line": line})

if __name__ == "__main__":
    app.run(host="0.0.0.0", port=5000, deb
???END
